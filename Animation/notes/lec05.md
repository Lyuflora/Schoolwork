# 计算机动画
lec 05 过程流体 水 烟雾

---

## 柏林噪声

### 三维噪声函数
`noise()`是一个被广泛使用的过程纹理函数，可以生成逼真的自然纹理。


`noise()`输入： 三维空间点`(x, y, z)`<br>
输出：一个标量
特性：
- 旋转统计不变性
- 平移统计不变性
- 其频率带宽很窄

#### noise()实现方法
傅里叶变换(计算量大)/<br>
**Perlin**提出采用<b>三维整数网格</b>上的每个整数点`(x,y,z)`随意具有一个灰度值(0-255),作为该点的噪声
非整数点的噪声由**插值**得到，源于周围的8个整数点。

## 柏林函数
### 什么是柏林噪声？<br>


- 一个非常强大的算法，经常用于程序生成随机内容(用*种子*控制)，在游戏和其他像电影等多媒体领域广泛应用，发明者是Ken Perlin.
- 具体应用：Minecraft地形生成，云、水、火焰特效，模拟手绘线条、海浪.

### 数学原理是什么，如何伪随机？

- 函数接收`x,y,`z三个坐标分量作为输入，并返回`0.0~1.0`的double值作为输出<br>
![](https://i.imgur.com/5hGDMAY.gif)
- 伪随机的结果来源于2部分：一是非整数点和整数点之间的相对位置（下文称`距离向量`），二是空间8个顶点的`梯度向量`，看似随机，实际上是可确定的：
	> 由12条单位正方体（3维）的中心点到各条边中点的向量组成
	`(1,1,0),(-1,1,0),(1,-1,0),(-1,-1,0), (1,0,1),(-1,0,1),(1,0,-1),(-1,0,-1), (0,1,1),(0,-1,1),(0,1,-1),(0,-1,-1)`

	> ![最初版算法：各顶点上的梯度向量随机选取结果](https://i.imgur.com/hWAnH0l.gif)
- 对每个顶点的梯度向量和距离向量做点积，得出每个顶点的影响：
`grad.x * dist.x + grad.y * dist.y + grad.z * dist.z`<br>
![2D柏林噪声的影响值](https://i.imgur.com/IpNz1xr.png)

- 对8个顶点的影响做插值

### 插值方法？

- 线性插值：速度快/结果差
- 三次样条插值：速度慢/结果光滑
- 平滑√


